<!DOCTYPE html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <link rel="stylesheet" href="{{ url_for('static', filename='styles/index2.css') }}">
    </head>
    <body>
        <div class='container' id="before">
            <div class='row'  style='margin-top:5px'>
                <div class='col-md-5'>
                    
                </div>
            </div>
            <div class='row' style='margin-top:5px'>
                <div class='col-md-3'>
                
                </div>
                <div class='col-md-6' id='first'>
                    
                    <form action="\reccomend" method="post">
                        <div class='input2'>
                            <input type='text' name="name" id='name' autocomplete="off" style='width:400px;color:black;'>
                        </div>
                        <div class='submit'>
                            <input type='submit' style='background-color: red;'>
                        </div>
                    </form>
                </div>
                <div class='col-md-3'>
                    
                </div>
            </div>
            <div class='row' style='margin-top:5px'>
                <div class='col-md-4' id="1">
                    <img src='https://image.tmdb.org/t/p/w185/9gk7adHYeDvHkCSEqAvQNLV5Uge.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('inception')">Inception</a></h4>
                </div>
                <div class='col-md-4' id="2">
                    <img src='https://image.tmdb.org/t/p/w185/da22ZBmrDOXOCDRvr8Gic8ldhv4.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('harry potter and the deathly hallows: part ii')">Harry potter and The Deathly Hallows: Part ii</a></h4>
                </div>
                <div class='col-md-4' id="3">
                    <img src='https://image.tmdb.org/t/p/w185/9xjZS2rlVxm8SFx8kPC3aIGCOYQ.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('titanic')">Titanic</a></h4>
                </div>
            </div>
            <div class='row'>
                <div class='col-md-4' id="4">
                    <img src='https://image.tmdb.org/t/p/w185/4q2NNj4S5dG2RLF9CpXsej7yXl.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('spider-man: far from home')">Spider-man: Far From Home</a></h4>
                </div>
                <div class='col-md-4' id="5">
                    <img src='https://image.tmdb.org/t/p/w185/rhr4y79GpxQF9IsfJItRXVaoGs4.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('jurassic world')">Jurassic World</a></h4>
                </div>
                <div class='col-md-4' id="6">
                    <img src='https://image.tmdb.org/t/p/w185/qWsHMrbg9DsBY3bCMk9jyYCRVRs.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('annabelle comes home')">Annabelle comes Home</a></h4>
                </div>
            </div>
            <div class='row'>
                <div class='col-md-4' id="7">
                    <img src='https://image.tmdb.org/t/p/w185/AkJQpZp9WoNdj7pLYSj1L0RcMMN.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('mission: impossible – fallout')">Mission: Impossible – Fallout</a></h4>
                </div>
                <div class='col-md-4' id="8">
                    <img src='https://image.tmdb.org/t/p/w185/fyy1nDC8wm553FCiBDojkJmKLCs.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('cars 3')">Cars 3</a></h4>
                </div>
                <div class='col-md-4' id="9">
                    <img src='https://image.tmdb.org/t/p/w185/w9kR8qbmQ01HwnvK4alvnQ2ca0L.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('toy story 4')">Toy Story 4</a></h4></a>
                </div>
            </div>
            <div class='row'>
                <div class='col-md-4' id="10">
                    <img src='https://image.tmdb.org/t/p/w185/gEU2QniE6E77NI6lCU6MxlNBvIx.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('interstellar')">Interstellar</a></h4>
                </div>
                <div class='col-md-4' id="11">
                    
                    <img src='https://image.tmdb.org/t/p/w185/dPrUPFcgLfNbmDL8V69vcrTyEfb.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('men in black: international')">Men in Black: International</a></h4>
                </div>
                <div class='col-md-4' id="12">
                    <img src='https://image.tmdb.org/t/p/w185/jRXYjXNq0Cs2TcJjLkki24MLp7u.jpg' width="230" height="350">
                    <h4 style='margin-left:20px'><a onclick="details('avatar')">Avatar</a></h4>
                </div>
            </div>
        </div>

        <script>
            var obj=JSON.parse({{ recc | tojson}});
            function fun(obj) {
                const keys = Object.keys(obj);
                const map = new Map();
                for(let i = 0; i < keys.length; i++){
                   //inserting new key value pair inside map
                   map.set(keys[i], obj[keys[i]]);
                }
                return map;
             }
              var temp='';
              var i=1;
              obj=fun(obj);
             obj.forEach((values,keys)=>{
                temp='<img src='+'"'+ values + '"'+' width="230" height="350" alt="Not available">';
                //temp=temp+ '<h3>' + keys + '</h3>';
                temp=temp+ '<a onclick="details(\''+keys+'\');"><h4 style="margin-left:20px">' + keys + '</h4></a>'
                let x=i.toString();
                document.getElementById(x).innerHTML=temp;
                i=i+1;
                console.log(keys)
              })
              //console.log(temp);
              //\''+keys+'\'
              function details(key){
                //var temp='<h1>'+ key+ '</h1>';
                //var x=typeof key;
                //$a=key
                //document.getElementById('before').innerHTML=temp;
                let info=key
                const request=new XMLHttpRequest()
                request.open('POST',`/details/${JSON.stringify(info)}`)
                request.onload=()=>{
                    const mess=request.responseText
                    console.log(mess)
                    var obj=JSON.parse(mess);
                    var x=typeof obj;
                    console.log( x)
                    const keys = Object.keys(obj);
                    const map = new Map();
                    for(let i = 0; i < keys.length; i++){
                        //inserting new key value pair inside map
                        map.set(keys[keys.length-i-1], obj[keys[keys.length-i-1]]);
                    }
                    obj=map
                    temp='';
                    obj.forEach((values,keys)=>{
                        console.log(keys)
                        if(keys=='poster'){
                        temp=temp+'<img src='+'"'+ values + '"'+' width="230" height="350" alt="Not available">';}
                        else{
                        temp=temp+"<h3>"+keys+" : "+ values +"</h3>";}
                        
                    })
                    document.getElementById('before').innerHTML=temp;
                    console.log(temp);
                }
                request.send()
            }
              if(obj.size>1){
              temp='<h3 style="color:white;">Here are some Reccomendations</h3>';
              document.getElementById('first').innerHTML=temp;}
        </script>
    </body>
</html>
